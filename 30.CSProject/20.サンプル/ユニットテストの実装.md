## ユニットテストの実装

### ユニットテストとは？
* プログラム構成のテスト


### 目的
* 品質向上
* バグの混入を防ぐ
* 仕様の可視化
* レガシーコード（テストコードが無い）からの脱却


### 方法
* 単体テストプロジェクトの実装


### 目標
* コンパイル時に毎回実施


### レビューの目的
* 規約にフィードバックしたい
* 事前に検討事項を抽出
* テストを考慮した実装
* メソッド内にロジックと外部DBIFが混在など


### 対象範囲
* 公開クラス
* メソッド
* 関数


### 課題
* １つの関数に複数の機能がある場合は？
  * 機能分割し小さい単位にリファクタリング
* フォームに実装がある場合は？
  * フォームに書かれた関数は private
  * フォームを View と ViewModel に分割し ViewModel に対してテストを行う
  * ただし改修に工数が掛かる
* DB へ接続とロジックがある場合？
  * インターフェイスを通じて結合
  * 通常の実行時には DB 接続しテスト時にはモックへ結合
* 例外処理はどうする？
  * ChainingAssertion を使用して戻り値を確認


### 使用ツール
* 単体テスト（MS 製）
* Nuget
  * Moq
    * 簡単にテスト用カスタムクラス相当のオブジェクトが作れる
    * １行で書ける
    * 可読性が良くなる
  * ChainingAssertion
    * Assertionの拡張
    * 例外処理が１つのメソッド内で書ける
    * 構文を意味が分かるよう記述できる
    * 一つのテストメソッドで正常と例外が書ける
     * 可読性が良くなる
* 拡張機能
  * AxoCover
    * カバレッジの測定
    * テストが通過したコードを可視化


* テストコード
  * メソッド名は日本語でOK
  * 他から呼ばれることは無い
  * 可読性を良くする
  * リファクタリングする

* ChainingAssertion の活用
  * 仕様が記録できる
  * 仕様追加、変更されたらテスト追加

### 議事
* エンティティモデルを使用したモデル時のテストの方法
* テストを作成することで肥大化しないか？ルールが必要

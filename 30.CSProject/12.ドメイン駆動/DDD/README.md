# 12.ドメイン駆動開発
ドメイン駆動開発

## プロジェクト構成
### Domain
・Repositories
  データの永続化
  インターフェイスを提供
  ・IWeatherEntitiy
    DataTableを使用せずカスタムクラス（Entitiy）を使用する

・ValueObject
  フォルダー名は分かりやすく。機能毎やシステム毎など
  DBから取得したデータを変換する（1=>"晴れ"など）
  ビジネスロジックの実装
  区分（ENum）は1か所にまとめておく 仕様も分かる
  ENumクラスを作っただけでは分からない
  しかもインテリセンスが効くようになる
  列挙体はロジックが書けない→ クラスは書ける


・Entities
  データの運び方
  一意性のあるデータのひとかたまり
  SQLなどで取得するデータ1行分
  型はDBの型をC#の型に置き換えたもの

  ・WethereEntity
    DataTableは使わない→カスタムクラスを使う
      遅い
      スペルミスをしてもコンパイルエラーにならない
      テストコードが書きにくい
    値とロジックを持つことで、ビジネスが集約される

・Helpers
  クラス名は意味が分かるようにする
  CsvHelper、FileHelper、FolderHelperなど
  staticでどこからも呼べる
  拡張メソッドでインテリセンスを統一できる



・ValueObject
  値として扱うクラス
  完全コンストラクタパターン（これは絶対）
  値とロジックを一体化させる
  現場でバグが生まれるのは値を基本の型で動かすから
  現場でロジックが散らばる原因は値を基本の型で動かすから
  DBの項目はすべてValueObjectにできるが、全てはできない
  ビジネスロジックがあるものは全てValueObjectにする
  DBからintで取ってきたものは、できるだけ早くValueObject（値とロジック）にする

  ・Temperature
    注意として演算子も実装しなければならない → 基底クラスでにて対応
    値の変換メソッドを実装した事によりインテリセンスが効く
    使い側は使用を理解する必要がない


### Infrastructure
・テクノロジー毎にフォルダーを作った方が良い
・SQLite、Folder、Postgresqlなど
・
・


### WinForm
・ViewとViewModelに分類する
・TestはViewModelに対して行う
・
  ・WeathrLatestViewModel
    2つのコンストラクターで評価と本番の切替ができる
    メソッドはValueObjectにすることで、ViewModelにはメソッドはなくなる
    ViewModelではValueObjectを表示するだけ
    データバインドでViewとViewModelを更新を楽にする
  ・ViewModelBase
    バインドをする為の基底クラス
    イベントハンドラ、プロパティー設定を実装
    MVVM支援ツールのprismのバインダブルコードを参考に



### Test.Tests
・すべてのプロジェクトのテストを行う
・カスタムクラスを使用したモックだと決まった値しか返せない
・Moqを使用することにより簡単に違う値のモックが作成可能
・



## その他
・parameterizedtestは便利ツール
  テスト引数をパラメータ化できる
・クラスの型を作ってパラメータ化する。可読性が良くなる
  質問と回答を変数化し引数で渡してあげる



## ゴール
・コード内に仕様がわかる
・必要なコードのみになる
・リファクタリングが可能。心配しなくてよい

## TDDについて
・後からテストを書くと必要なパターンが漏れる
・カバレッジは抜けても分からない
・privateはどうする？
  publicにする

## ChainingAssertionについて
・例外も一つのテストメソッド内で書ける
・構文がわかりやすくなる



